{
  "version": 3,
  "sources": ["../../../src/dialects/mariadb/query-generator-typescript.ts"],
  "sourcesContent": ["import { rejectInvalidOptions } from '../../utils/check';\nimport { joinSQLFragments } from '../../utils/join-sql-fragments';\nimport { generateIndexName } from '../../utils/string';\nimport { REMOVE_INDEX_QUERY_SUPPORTABLE_OPTIONS } from '../abstract/query-generator-typescript';\nimport type { RemoveIndexQueryOptions, TableNameOrModel } from '../abstract/query-generator-typescript';\nimport { MySqlQueryGenerator } from '../mysql/query-generator.js';\n\nconst REMOVE_INDEX_QUERY_SUPPORTED_OPTIONS = new Set<keyof RemoveIndexQueryOptions>(['ifExists']);\n\n/**\n * Temporary class to ease the TypeScript migration\n */\nexport class MariaDbQueryGeneratorTypeScript extends MySqlQueryGenerator {\n  removeIndexQuery(\n    tableName: TableNameOrModel,\n    indexNameOrAttributes: string | string[],\n    options?: RemoveIndexQueryOptions,\n  ) {\n    if (options) {\n      rejectInvalidOptions(\n        'removeIndexQuery',\n        this.dialect.name,\n        REMOVE_INDEX_QUERY_SUPPORTABLE_OPTIONS,\n        REMOVE_INDEX_QUERY_SUPPORTED_OPTIONS,\n        options,\n      );\n    }\n\n    let indexName;\n    if (Array.isArray(indexNameOrAttributes)) {\n      const table = this.extractTableDetails(tableName);\n      indexName = generateIndexName(table, { fields: indexNameOrAttributes });\n    } else {\n      indexName = indexNameOrAttributes;\n    }\n\n    return joinSQLFragments([\n      'DROP INDEX',\n      options?.ifExists ? 'IF EXISTS' : '',\n      this.quoteIdentifier(indexName),\n      'ON',\n      this.quoteTable(tableName),\n    ]);\n  }\n\n  jsonPathExtractionQuery(sqlExpression: string, path: ReadonlyArray<number | string>, unquote: boolean): string {\n    const sql = super.jsonPathExtractionQuery(sqlExpression, path, unquote);\n\n    if (unquote) {\n      return sql;\n    }\n\n    // MariaDB has a very annoying behavior with json_extract: It returns the JSON value as a proper JSON string (e.g. \"true\" or \"null\" instead true or null)\n    // Except if the value is going to be used in a comparison, in which case it unquotes it automatically (even if we did not call JSON_UNQUOTE).\n    // This is a problem because it makes it impossible to distinguish between a JSON text \"true\" and a JSON boolean true.\n    // This useless function call is here to make mariadb not think the value will be used in a comparison, and thus not unquote it.\n    // We could replace it with a custom function that does nothing, but this would require a custom function to be created on the database ahead of time.\n    return `json_compact(${sql})`;\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAqC;AACrC,gCAAiC;AACjC,oBAAkC;AAClC,wCAAuD;AAEvD,6BAAoC;AAEpC,MAAM,uCAAuC,oBAAI,IAAmC,CAAC,UAAU,CAAC;AAKzF,MAAM,wCAAwC,2CAAoB;AAAA,EACvE,iBACE,WACA,uBACA,SACA;AACA,QAAI,SAAS;AACX;AAAA,QACE;AAAA,QACA,KAAK,QAAQ;AAAA,QACb;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAEA,QAAI;AACJ,QAAI,MAAM,QAAQ,qBAAqB,GAAG;AACxC,YAAM,QAAQ,KAAK,oBAAoB,SAAS;AAChD,sBAAY,iCAAkB,OAAO,EAAE,QAAQ,sBAAsB,CAAC;AAAA,IACxE,OAAO;AACL,kBAAY;AAAA,IACd;AAEA,eAAO,4CAAiB;AAAA,MACtB;AAAA,OACA,mCAAS,YAAW,cAAc;AAAA,MAClC,KAAK,gBAAgB,SAAS;AAAA,MAC9B;AAAA,MACA,KAAK,WAAW,SAAS;AAAA,IAC3B,CAAC;AAAA,EACH;AAAA,EAEA,wBAAwB,eAAuB,MAAsC,SAA0B;AAC7G,UAAM,MAAM,MAAM,wBAAwB,eAAe,MAAM,OAAO;AAEtE,QAAI,SAAS;AACX,aAAO;AAAA,IACT;AAOA,WAAO,gBAAgB;AAAA,EACzB;AACF;",
  "names": []
}
